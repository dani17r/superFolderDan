import{p as I,q as c,J as O,E as u,x as b,y as F,I as N,_ as U,r as g,T as R,s as x,t as d,u as l,F as z,P as q,S as A,h as G,c as J,B as j,C as K,N as W,U as H,j as C,V as Y,Q as V,v as L,G as B,f as X,K as Z,L as ee,M as te}from"./index-DHSe1Man.js";import{Q as le}from"./QPage-CRXg9CLo.js";import{s as $}from"./superComposable-tYNyz0Wa.js";import{g as M,Q as y}from"./rules-C7FQSbBy.js";import{a as h,Q as T}from"./QCard-BzzgrVoD.js";import{Q as ae}from"./QDialog-BVwIGhzB.js";import{C as k}from"./ClosePopup-CUQAiiAZ.js";import{b as se,a as E,Q}from"./TouchPan-MdoHDnAh.js";import{Q as oe}from"./QMenu-DdFdiw-l.js";import{C as ne}from"./ContentFiles-6lve4miX.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./QResizeObserver-BKTGu071.js";const ie=m=>{if(m?.target instanceof HTMLInputElement){const i=new File([],"empty.txt",{type:"text/plain"}),r=new DataTransfer;r.items.add(i),m.target.files=r.files}},re=m=>m.slice((m.lastIndexOf(".")-1>>>0)+2),ue=m=>{const i=m.lastIndexOf(".");return i===-1?m:m.substring(0,i)},de=m=>{const i=new Date(m),r=String(i.getDate()).padStart(2,"0"),s=String(i.getMonth()+1).padStart(2,"0"),a=i.getFullYear();let o=i.getHours();const e=String(i.getMinutes()).padStart(2,"0"),t=o>=12?"PM":"AM";return o=o%12||12,`${r}/${s}/${a} ${o}:${e} ${t}`},me={class:"tw-flex tw-flex-col tw-relative"},fe={class:"tw-text-lg"},pe=u("b",null,"Name",-1),ce={class:"col-span-2 tw-mb-4"},ve={class:"tw-text-md"},_e=u("b",null,"Id Doc",-1),we={class:"tw-text-md"},ge=u("b",null,"Owner",-1),Fe={class:"tw-text-md"},xe=u("b",null,"size",-1),ye={class:"tw-text-md"},be=u("b",null,"type",-1),Ue=["src"],De={class:"tw-fixed tw-bottom-11"},Ve=I({__name:"previewUploadFiles",props:{formDefault:{}},setup(m){const{store:i}=$(),r=m;return(s,a)=>(c(),O("div",me,[u("h1",fe,[pe,b(": "+F(r.formDefault.name),1)]),u("div",ce,[u("p",ve,[_e,b(": "+F(r.formDefault.id_doc),1)]),u("p",we,[ge,b(": "+F(r.formDefault.owner),1)]),u("p",Fe,[xe,b(": "+F((parseFloat(r.formDefault.size)/1024).toFixed(1))+" kiB ",1)]),u("p",ye,[be,b(": "+F(r.formDefault.type),1)])]),u("iframe",{src:N(i).files.getMedia(String(r.formDefault.url)),class:"iframe-preview-view"},null,8,Ue),u("div",De," Created At: "+F(N(de)(r.formDefault.created_at)),1)]))}}),he=U(Ve,[["__file","previewUploadFiles.vue"]]),$e={class:"frame-container"},Se=["src"],Ce=I({__name:"EditeUploadFiles",props:{formDefault:{}},emits:["success"],setup(m,{emit:i}){const{store:r,$q:s}=$(),a=m,o=i,e={name:{val:g(""),refs:g(null),rules:[M.empty]},owner:{val:g(""),refs:g(null),rules:[M.empty]},amount_pages:{val:g(0),refs:g(null),rules:[D=>D>0||"Cannot be less than or equal to zero"]}},t=()=>{e.name.refs.value?.validate(),e.owner.refs.value?.validate(),e.amount_pages.refs.value?.validate(),!e.name.refs.value.hasError&&!e.owner.refs.value.hasError&&!e.amount_pages.refs.value.hasError&&(s.loading.show(),r.files.updateFile({id:a.formDefault.id,name:e.name.val.value,owner:e.owner.val.value,amount_pages:e.amount_pages.val.value,folder_id:a.formDefault.folder_id,user_id:a.formDefault.user_id},()=>{o("success"),s.loading.hide(),A.success({message:"Success Upload"})}),setTimeout(()=>s.loading.hide(),1e3))},S=()=>{e.name.val.value="",e.owner.val.value="",e.amount_pages.val.value=0,setTimeout(()=>{e.name.refs.value.resetValidation(),e.owner.refs.value.resetValidation()},10)};return R(()=>{a.formDefault&&(e.name.val.value=String(a.formDefault.name),e.owner.val.value=String(a.formDefault.owner),e.amount_pages.val.value=Number(a.formDefault.amount_pages))}),(D,w)=>(c(),x(T,{class:"box-card-content"},{default:d(()=>[u("div",$e,[u("iframe",{src:N(r).files.getMedia(String(a.formDefault.url)),class:"iframe-preview-upload",id:"preview-upload"},null,8,Se)]),u("form",{onSubmit:q(t,["prevent","stop"]),onReset:q(S,["prevent","stop"])},[l(h,null,{default:d(()=>[l(y,{dense:"",outlined:"","model-value":a.formDefault.id_doc,label:"Id Doc",class:"q-mt-md",disable:""},null,8,["model-value"]),l(y,{dense:"",outlined:"",modelValue:e.name.val.value,"onUpdate:modelValue":w[0]||(w[0]=f=>e.name.val.value=f),label:"File Name",class:"q-mt-md",ref:f=>e.name.refs.value=f,rules:e.name.rules},null,8,["modelValue","rules"]),l(y,{dense:"",outlined:"",modelValue:e.owner.val.value,"onUpdate:modelValue":w[1]||(w[1]=f=>e.owner.val.value=f),label:"First Name & last Name",class:"q-mt-md",ref:f=>e.owner.refs.value=f,rules:e.owner.rules},null,8,["modelValue","rules"]),l(y,{dense:"",outlined:"",type:"number",modelValue:e.amount_pages.val.value,"onUpdate:modelValue":w[2]||(w[2]=f=>e.amount_pages.val.value=f),label:"Amount Of Pages",class:"q-mt-md",ref:f=>e.amount_pages.refs.value=f,rules:e.amount_pages.rules},null,8,["modelValue","rules"]),l(y,{dense:"",outlined:"","model-value":a.formDefault.size,label:"File Name",class:"q-mt-md",disable:""},null,8,["model-value"])]),_:1}),l(h,null,{default:d(()=>[l(z,{unelevated:"",color:"primary",label:"Update","no-caps":"",class:"full-width tw-rounded-lg no-shadow",type:"submit"})]),_:1})],32)]),_:1}))}}),ke=U(Ce,[["__file","EditeUploadFiles.vue"]]),Ne={class:"frame-container"},ze=["src"],Ee=I({__name:"NewUploadFiles",props:{formDefault:{}},emits:["success"],setup(m,{emit:i}){const{store:r,route:s,$q:a}=$(),o=m,e=i,t={name:{val:g(""),refs:g(null),rules:[M.empty]},owner:{val:g(""),refs:g(null),rules:[M.empty]},amount_pages:{val:g(0),refs:g(null),rules:[w=>w>=0||"Cannot be less than or equal to zero"]}},S=()=>{t.name.refs.value?.validate(),t.owner.refs.value?.validate(),t.amount_pages.refs.value?.validate(),!t.name.refs.value.hasError&&!t.owner.refs.value.hasError&&!t.amount_pages.refs.value.hasError&&(a.loading.show(),r.files.uploadFile({amount_pages:Number(t.amount_pages.val.value||1),folder_id:Number(s.params?.id||null),user_id:String(r.auth.current?.id),id_doc:o.formDefault.id_doc,size:o.formDefault.size,type:o.formDefault.type,file:o.formDefault.file,owner:t.owner.val.value,name:t.name.val.value},()=>{e("success"),a.loading.hide(),A.success({message:"Success Upload"})}),setTimeout(()=>a.loading.hide(),1e3))},D=()=>{t.name.val.value="",t.owner.val.value="",t.amount_pages.val.value=0,setTimeout(()=>{t.name.refs.value.resetValidation(),t.owner.refs.value.resetValidation(),t.amount_pages.refs.value.resetValidation()},10)};return R(()=>{o.formDefault&&(t.name.val.value=o.formDefault.name,t.owner.val.value=o.formDefault.owner,t.amount_pages.val.value=o.formDefault.amount_pages)}),(w,f)=>(c(),x(T,{class:"box-card-content"},{default:d(()=>[u("div",Ne,[u("iframe",{src:o.formDefault.preview,class:"iframe-preview-upload",id:"preview-upload"},null,8,ze)]),u("form",{onSubmit:q(S,["prevent","stop"]),onReset:q(D,["prevent","stop"])},[l(h,null,{default:d(()=>[l(y,{dense:"",outlined:"","model-value":o.formDefault.id_doc,label:"Id Doc",class:"q-mt-md",disable:""},null,8,["model-value"]),l(y,{dense:"",outlined:"",modelValue:t.name.val.value,"onUpdate:modelValue":f[0]||(f[0]=v=>t.name.val.value=v),label:"File Name",class:"q-mt-md",ref:v=>t.name.refs.value=v,rules:t.name.rules},null,8,["modelValue","rules"]),l(y,{dense:"",outlined:"",modelValue:t.owner.val.value,"onUpdate:modelValue":f[1]||(f[1]=v=>t.owner.val.value=v),label:"First Name & last Name",class:"q-mt-md",ref:v=>t.owner.refs.value=v,rules:t.owner.rules},null,8,["modelValue","rules"]),l(y,{dense:"",outlined:"",type:"number",modelValue:t.amount_pages.val.value,"onUpdate:modelValue":f[2]||(f[2]=v=>t.amount_pages.val.value=v),label:"Amount Of Pages",class:"q-mt-md",ref:v=>t.amount_pages.refs.value=v,rules:t.amount_pages.rules},null,8,["modelValue","rules"]),l(y,{dense:"",outlined:"","model-value":o.formDefault.size,label:"File Name",class:"q-mt-md",disable:""},null,8,["model-value"])]),_:1}),l(h,null,{default:d(()=>[l(z,{unelevated:"",color:"primary",label:"Upload","no-caps":"",class:"full-width tw-rounded-lg no-shadow",type:"submit"})]),_:1})],32)]),_:1}))}}),Qe=U(Ee,[["__file","NewUploadFiles.vue"]]),qe=G("div",{class:"q-space"}),Me=J({name:"QSpace",setup(){return()=>qe}}),Ie={class:"text-h6"},Be={__name:"MainDialog",props:j({title:{type:String,default:"Dialog",required:!0},styleCard:{type:String},classCard:{type:String}},{modelValue:!1,modelModifiers:{}}),emits:j(["close"],["update:modelValue"]),setup(m,{emit:i}){const r=K(m,"modelValue",!1),s=i,a=m;return(o,e)=>(c(),x(ae,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=t=>r.value=t),class:"tw-relative"},{default:d(()=>[l(T,{style:W(a.styleCard),class:H(a.classCard)},{default:d(()=>[l(h,{class:"row items-center q-pb-none"},{default:d(()=>[u("div",Ie,F(a.title),1),l(Me),C(l(z,{icon:"close",flat:"",round:"",dense:"",onClick:e[0]||(e[0]=t=>s("close"))},null,512),[[k]])]),_:1}),l(h,null,{default:d(()=>[Y(o.$slots,"default")]),_:3})]),_:3},8,["style","class"])]),_:3},8,["modelValue"]))}},P=U(Be,[["__file","MainDialog.vue"]]),Pe={class:"tw-flex tw-justify-center tw-items-center tw-flex-col"},Oe={class:"thumbnail-container"},Te=["src"],je={class:"text-center"},Le={class:"text-center"},Re={__name:"previewFile",props:{size:{type:String},url:{type:String},fixed:{type:Boolean},type:{type:String},name:{type:String,default:""},id:{type:Number}},emits:["fixedFile","openFile","editeFile","deleteFile","blurInput"],setup(m,{emit:i}){const{store:r}=$(),s=i,a=m;return(o,e)=>(c(),O("div",{class:H(["text-center tw-flex tw-flex-col tw-justify-center tw-items-center",a.fixed?"tw-mt-[-35px]":""])},[l(z,{"fab-mini":"",round:"",color:"primary",size:"5px",icon:"more_vert",class:"tw-z-[100] tw-mb-[-40px] tw-mr-[-90px]"},{default:d(()=>[l(oe,null,{default:d(()=>[l(se,{dense:"",style:{"min-width":"100px"}},{default:d(()=>[C((c(),x(E,{clickable:"",onClick:e[0]||(e[0]=t=>s("openFile",a.id))},{default:d(()=>[l(V,{color:"secondary",name:"file_copy",class:"tw-mt-[4px] tw-mr-[4px]",size:"20px"}),l(Q,null,{default:d(()=>[b("Open File")]),_:1})]),_:1})),[[k]]),C((c(),x(E,{clickable:"",onClick:e[1]||(e[1]=t=>s("editeFile",a.id))},{default:d(()=>[l(V,{color:"secondary",name:"edit",class:"tw-mt-[4px] tw-mr-[4px]",size:"20px"}),l(Q,null,{default:d(()=>[b("Edite File")]),_:1})]),_:1})),[[k]]),C((c(),x(E,{clickable:"",onClick:e[2]||(e[2]=t=>s("fixedFile",a.id))},{default:d(()=>[l(V,{color:"secondary",name:"keyboard_double_arrow_right",class:"tw-mt-[4px] tw-mr-[4px]",size:"20px"}),l(Q,null,{default:d(()=>[b(F(a.fixed?"Unfix File":"Fixed File"),1)]),_:1})]),_:1})),[[k]]),a.fixed?L("",!0):C((c(),x(E,{key:0,clickable:"",onClick:e[3]||(e[3]=t=>s("deleteFile",a.id))},{default:d(()=>[l(V,{color:"secondary",name:"delete",class:"tw-mt-[4px] tw-mr-[4px]",size:"20px"}),l(Q,null,{default:d(()=>[b("Delete files")]),_:1})]),_:1})),[[k]])]),_:1})]),_:1})]),_:1}),u("div",Pe,[u("div",Oe,[u("iframe",{src:N(r).files.getMedia(a.url),class:"iframe-preview",frameborder:"0"},null,8,Te)]),u("p",je,F(a.name)+"."+F(a.type),1),u("p",Le,F(parseFloat(Number(a.size)/1024).toFixed(1))+" kiB ",1)]),a.fixed?(c(),x(V,{key:0,name:"push_pin",size:"20px",color:"accent",class:"tw-z-[100] tw-mt-[-60px] tw-mr-[-100px]"})):L("",!0)],2))}},Ae=U(Re,[["__file","previewFile.vue"]]),He=I({__name:"ButtonBack",setup(m){const{route:i,router:r}=$(),s=()=>{i.path.includes("dashboard/folder")?r.go(-1):r.push({name:"home"})};return(a,o)=>(c(),x(z,{round:"",color:"primary",icon:"keyboard_backspace",onClick:o[0]||(o[0]=e=>s())}))}}),Ge=U(He,[["__file","ButtonBack.vue"]]),Je={class:"text-center"},Ke={__name:"FolderPage",setup(m){const{store:i,route:r}=$(),s=B({newUploadFile:{status:!1,toggle:()=>{s.newUploadFile.status=!s.newUploadFile.status}},editUploadFile:{status:!1,toggle:()=>{s.editUploadFile.status=!s.editUploadFile.status}},viewUploadFile:{status:!1,toggle:()=>{s.viewUploadFile.status=!s.viewUploadFile.status}}}),a=B({}),o=B({amount_pages:0,owner:"",id_doc:"",preview:"",name:"",size:"",file:File}),e=_=>{let n=i.files.data.find(p=>p.id==_);if(n)for(const p in n)a[p]=n[p]},t=_=>{e(_),s.editUploadFile.toggle()},S=_=>{e(_),s.viewUploadFile.toggle()},D=_=>{const n=_.target.files[0];n&&(o.owner=i.auth.current.user_metadata.fullname,o.name=ue(n.name),o.preview=URL.createObjectURL(n),o.type=re(n.name),o.id_doc=crypto.randomUUID(),o.size=n.size,o.file=n,s.newUploadFile.toggle(),setTimeout(()=>ie(_),100))},w=()=>document.getElementById("file-input").click(),f=_=>i.files.deleteFile(_),v=_=>{let n=i.files.data.find(p=>p.id==_);i.files.updateFile({folder_id:n.folder_id,user_id:n.user_id,fixed:!n.fixed,id:n.id})};return X(()=>{i.files.getFilesOfUser(i.auth.current.id,Number(r.params.id))}),(_,n)=>(c(),x(le,{class:"row items-center justify-evenly"},{default:d(()=>[l(Ge,{class:"tw-fixed tw-top-[85px] tw-right-3 tw-z-50"}),l(ne,null,{default:d(()=>[u("div",Je,[l(V,{name:"note_add",size:"80px",color:"primary",class:"tw-opacity-50 tw-cursor-pointer",onClick:n[0]||(n[0]=p=>w())}),u("p",{class:"text-accent tw-cursor-pointer",onClick:n[1]||(n[1]=p=>w())}," New File "),u("input",{type:"file",id:"file-input",name:"file",onChange:D,style:{display:"none"},accept:".doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,text/plain,.pdf,.jpg,.jpeg,.png",required:""},null,32)]),(c(!0),O(ee,null,Z(N(i).files.data,p=>(c(),x(Ae,te({key:p.id,ref_for:!0},p,{onDeleteFile:f,onEditeFile:t,onOpenFile:S,onFixedFile:v}),null,16))),128))]),_:1}),l(P,{modelValue:s.newUploadFile.status,"onUpdate:modelValue":n[3]||(n[3]=p=>s.newUploadFile.status=p),title:"New File",persistent:""},{default:d(()=>[l(Qe,{"form-default":o,onSuccess:n[2]||(n[2]=p=>s.newUploadFile.toggle())},null,8,["form-default"])]),_:1},8,["modelValue"]),l(P,{modelValue:s.editUploadFile.status,"onUpdate:modelValue":n[5]||(n[5]=p=>s.editUploadFile.status=p),title:"Update File"},{default:d(()=>[l(ke,{"form-default":a,onSuccess:n[4]||(n[4]=p=>s.editUploadFile.toggle())},null,8,["form-default"])]),_:1},8,["modelValue"]),l(P,{modelValue:s.viewUploadFile.status,"onUpdate:modelValue":n[7]||(n[7]=p=>s.viewUploadFile.status=p),title:"View File","class-card":"tw-min-w-[90vw] tw-min-h-[90vh] md:tw-min-w-[42vw] md:tw-min-h-[90vh]"},{default:d(()=>[l(he,{"form-default":a,onSuccess:n[6]||(n[6]=p=>s.viewUploadFile.toggle())},null,8,["form-default"])]),_:1},8,["modelValue"])]),_:1}))}},rt=U(Ke,[["__file","FolderPage.vue"]]);export{rt as default};
